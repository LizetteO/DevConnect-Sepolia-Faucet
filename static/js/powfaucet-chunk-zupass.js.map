{"version":3,"file":"powfaucet-chunk-zupass.js","mappings":"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","sources":["webpack://pow-faucet-client/./src/components/frontpage/ZupassLogin.tsx"],"sourcesContent":["import React from 'react';\nimport { IFaucetConfig } from '../../common/FaucetConfig';\n\nimport './ZupassLogin.css';\nimport { IFaucetContext } from '../../common/FaucetContext';\n\nimport { EdDSATicketPCDPackage } from \"@pcd/eddsa-ticket-pcd\";\nimport { SemaphoreIdentityPCDPackage } from \"@pcd/semaphore-identity-pcd\";\nimport { ArgumentTypeName } from \"@pcd/pcd-types\";\nimport { ArgsOf, PCDPackage } from \"@pcd/pcd-types\";\nimport {\n  ZKEdDSAEventTicketPCDArgs,\n  ZKEdDSAEventTicketPCDPackage\n} from \"@pcd/zk-eddsa-event-ticket-pcd\";\nimport { OverlayTrigger, Tooltip } from 'react-bootstrap';\nimport { IZupassLogin } from './ZupassLoginInterface';\n\nexport interface IZupassLoginProps {\n  faucetContext: IFaucetContext;\n  faucetConfig: IFaucetConfig;\n  forwardRef: React.RefObject<IZupassLogin>;\n}\n\nexport interface IZupassLoginState {\n  popupOpen: boolean;\n  authInfo: IZupassAuthInfo;\n}\n\nexport interface IZupassAuthInfo {\n  ticketId: string;\n  productId: string;\n  eventId: string;\n  attendeeId: string;\n  token: string;\n}\n\nexport enum PCDRequestType {\n  Get = \"Get\",\n  GetWithoutProving = \"GetWithoutProving\",\n  Add = \"Add\",\n  ProveAndAdd = \"ProveAndAdd\"\n}\n\nexport interface PCDRequest {\n  returnUrl: string;\n  type: PCDRequestType;\n}\n\nexport interface ProveOptions {\n  genericProveScreen?: boolean;\n  title?: string;\n  description?: string;\n  debug?: boolean;\n  proveOnServer?: boolean;\n  signIn?: boolean;\n}\n\nexport interface PCDGetRequest<T extends PCDPackage = PCDPackage>\n  extends PCDRequest {\n  type: PCDRequestType.Get;\n  pcdType: T[\"name\"];\n  args: ArgsOf<T>;\n  options?: ProveOptions;\n}\n\nexport class ZupassLogin extends React.PureComponent<IZupassLoginProps, IZupassLoginState> {\n  private messageEvtListener: (evt: MessageEvent) => void;\n  private loginPopop: Window;\n\n  constructor(props: IZupassLoginProps, state: IZupassLoginState) {\n    super(props);\n    (this.props.forwardRef as any).current = this;\n\n    this.messageEvtListener = (evt: MessageEvent) => this.processWindowMessage(evt);\n\n    this.state = {\n      popupOpen: false,\n      authInfo: null,\n\t\t};\n  }\n\n  public componentDidMount() {\n    window.addEventListener(\"message\", this.messageEvtListener);\n    if(localStorage['zupass.AuthResult']) {\n      try {\n        this.processLoginResult(JSON.parse(localStorage['zupass.AuthResult']));\n        localStorage.removeItem(\"zupass.AuthResult\");\n      } catch(ex) {\n        console.error(\"error parsing auth result from localstorage: \", ex);\n      }\n    }\n    else if(localStorage['zupass.AuthInfo']) {\n      try {\n        let authInfo = JSON.parse(localStorage['zupass.AuthInfo']);\n        this.loadAuthInfo(authInfo);\n      } catch(ex) {\n        console.error(\"error parsing auth info from localstorage: \", ex);\n      }\n    }\n\n  }\n\n  public componentWillUnmount() {\n    window.removeEventListener(\"message\", this.messageEvtListener);\n    this.loginPopop = null;\n  }\n\n\tpublic render(): React.ReactElement {\n\n    return (\n      <div className='faucet-zupass-auth'>\n        <div className='auth-icon'>\n          <div className='logo logo-zupass' style={{backgroundImage: \"url('/images/devconnect-ist.png')\"}}></div>\n        </div>\n        {this.state.authInfo ?\n          this.renderLoginState() :\n          this.renderLoginButton()\n        }\n      </div>\n    );\n\t}\n\n  private renderLoginButton(): React.ReactElement {\n    return (\n      <div className='auth-field auth-noauth' onClick={(evt) => this.onLoginClick()}>\n        <div>\n          DevConnect attendee? Login with your Ticket.\n          {this.props.faucetConfig.modules.zupass.infoHtml ?\n            <OverlayTrigger\n              placement=\"bottom\"\n              overlay={this.renderInfoHtml()}\n            >\n              <span className=\"zupass-info-icon\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" className=\"bi bi-info-circle\" viewBox=\"0 0 16 16\">\n                  <path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\"/>\n                  <path d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z\"/>\n                </svg>\n              </span>\n            </OverlayTrigger>\n          : null}\n        </div>\n        <div>\n          <a href=\"#\" onClick={(evt) => evt.preventDefault()}>\n            {this.state.popupOpen ?\n              <span className='inline-spinner'>\n                <img src=\"/images/spinner.gif\" className=\"spinner\" />\n              </span>\n            : null}\n            Login with Zupass\n          </a>\n        </div>\n      </div>\n    );\n  }\n\n  private renderLoginState(): React.ReactElement {\n    return (\n      <div className='auth-field auth-profile'>\n        <div className='auth-info'>\n          Authenticated with Devconnect Ticket. {this.props.faucetConfig.modules.zupass.infoHtml ?\n            <OverlayTrigger\n              placement=\"bottom\"\n              overlay={this.renderInfoHtml()}\n            >\n              <span className=\"zupass-info-icon\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" className=\"bi bi-info-circle\" viewBox=\"0 0 16 16\">\n                  <path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\"/>\n                  <path d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z\"/>\n                </svg>\n              </span>\n            </OverlayTrigger>\n          : null}\n        </div>\n        <div className=\"auth-logout\">\n          <a href=\"#\" onClick={(evt) => {evt.preventDefault(); this.onLogoutClick()}}>\n            Logout\n          </a>\n        </div>\n        <div className='auth-info'>\n          Attendee ID: \n          <OverlayTrigger\n            placement=\"bottom\"\n            delay={{ show: 250, hide: 400 }}\n            overlay={(props) => this.renderZupassTicketInfo(this.state.authInfo, props)}\n          >\n            <span className=\"auth-ident-truncated\">{this.state.authInfo.attendeeId}</span>\n          </OverlayTrigger>\n        </div>\n      </div>\n    );\n  }\n\n  private renderZupassTicketInfo(ticketInfo: IZupassAuthInfo, props: any): React.ReactElement {\n    if(!ticketInfo)\n      return null;\n    \n    return (\n      <Tooltip id=\"zupass-tooltip\" {...props}>\n        <div className='zupass-info'>\n          <table>\n            <tbody>\n              <tr>\n                <td className='zupass-title'>TicketId:</td>\n                <td className='zupass-value'>{ticketInfo.ticketId}</td>\n              </tr>\n              <tr>\n                <td className='zupass-title'>EventId:</td>\n                <td className='zupass-value'>{ticketInfo.eventId}</td>\n              </tr>\n              <tr>\n                <td className='zupass-title'>ProductId:</td>\n                <td className='zupass-value'>{ticketInfo.productId}</td>\n              </tr>\n              <tr>\n                <td className='zupass-title'>Attendee:</td>\n                <td className='zupass-value'>{ticketInfo.attendeeId}</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </Tooltip>\n    );\n  }\n\n  private renderInfoHtml(): React.ReactElement {\n    if(!this.props.faucetConfig.modules.zupass.infoHtml)\n      return null;\n    \n    return (\n      <Tooltip id=\"zupass-tooltip\">\n        <div className='zupass-info' dangerouslySetInnerHTML={{__html: this.props.faucetConfig.modules.zupass.infoHtml}}></div>\n      </Tooltip>\n    );\n  }\n\n  public getToken(): string {\n    return this.state.authInfo?.token;\n  }\n  \n  private onLoginClick() {\n\n    const args: ZKEdDSAEventTicketPCDArgs = {\n      ticket: {\n        argumentType: ArgumentTypeName.PCD,\n        pcdType: EdDSATicketPCDPackage.name,\n        value: undefined,\n        userProvided: true,\n        validatorParams: {\n          eventIds: this.props.faucetConfig.modules.zupass.event.eventIds,\n          productIds: this.props.faucetConfig.modules.zupass.event.productIds,\n          notFoundMessage: \"No eligible PCDs found\"\n        }\n      },\n      identity: {\n        argumentType: ArgumentTypeName.PCD,\n        pcdType: SemaphoreIdentityPCDPackage.name,\n        value: undefined,\n        userProvided: true\n      },\n      validEventIds: {\n        argumentType: ArgumentTypeName.StringArray,\n        value: this.props.faucetConfig.modules.zupass.event.eventIds.length != 0 ? this.props.faucetConfig.modules.zupass.event.eventIds : undefined,\n        userProvided: false\n      },\n      fieldsToReveal: {\n        argumentType: ArgumentTypeName.ToggleList,\n        value: {\n          revealTicketId: true,\n          revealEventId: true,\n          revealAttendeeSemaphoreId: true,\n          revealProductId: true,\n        },\n        userProvided: false\n      },\n      externalNullifier: {\n        argumentType: ArgumentTypeName.BigInt,\n        value: this.props.faucetConfig.modules.zupass.nullifier,\n        userProvided: false\n      },\n      watermark: {\n        argumentType: ArgumentTypeName.BigInt,\n        value: this.props.faucetConfig.modules.zupass.watermark,\n        userProvided: false\n      }\n    };\n\n    const req: PCDGetRequest<typeof ZKEdDSAEventTicketPCDPackage> = {\n      type: PCDRequestType.Get,\n      returnUrl: this.props.faucetConfig.modules.zupass.redirectUrl || this.props.faucetContext.faucetApi.getApiUrl(\"/zupassCallback\", true),\n      args: args,\n      pcdType: \"zk-eddsa-event-ticket-pcd\",\n      options: {\n        genericProveScreen: true,\n        title: \"ZKEdDSA Proof\",\n        description: \"zkeddsa ticket pcd request\"\n      }\n    };\n    const encReq = encodeURIComponent(JSON.stringify(req));\n    let url = `${this.props.faucetConfig.modules.zupass.url}#/prove?request=${encReq}`;\n\n    this.loginPopop = window.open(url, \"_blank\", \"width=450,height=600,top=100,popup\");\n\n    if(!this.state.popupOpen) {\n      this.setState({\n        popupOpen: true,\n      }, () => {\n        this.pollPopupState();\n      });\n    }\n  }\n  \n  private onLogoutClick() {\n    localStorage.removeItem(\"zupass.AuthInfo\");\n    this.setState({\n      authInfo: null,\n    });\n  }\n\n\n  private pollPopupState() {\n    if(!this.loginPopop)\n      return;\n    \n    if(!this.state.popupOpen)\n      return;\n    if(this.loginPopop.closed) {\n      this.setState({\n        popupOpen: false,\n      });\n      this.loginPopop = null;\n    }\n    else {\n      setTimeout(() => this.pollPopupState(), 1000);\n    }\n  }\n\n  private processWindowMessage(evt: MessageEvent) {\n    if(!evt.data || typeof evt.data !== \"object\" || evt.data.authModule !== \"zupass\" || !evt.data.authResult)\n      return;\n    this.processLoginResult(evt.data.authResult);\n  }\n\n  private processLoginResult(authResult: any) {\n    console.log(\"Zupass auth: \", authResult);\n    if(this.loginPopop)\n      this.loginPopop.close();\n    if(authResult.data) {\n      this.loadAuthInfo(authResult.data);\n      localStorage['zupass.AuthInfo'] = JSON.stringify(authResult.data);\n    }\n    else if(authResult.errorCode) {\n      this.props.faucetContext.showDialog({\n        title: \"Could not authenticate with zupass\",\n        body: (<div className='alert alert-danger'>[{authResult.errorCode}] {authResult.errorMessage}</div>),\n        closeButton: { caption: \"Close\" },\n      });\n    }\n  }\n\n  private loadAuthInfo(authInfo: IZupassAuthInfo) {\n    this.setState({\n      authInfo: authInfo,\n    });\n  }\n\n}\n\nexport default (props) => {\n  return (\n    <ZupassLogin \n      {...props}\n    />\n  );\n};\n"],"names":["PCDRequestType","ZupassLogin","_React$PureComponent","_inherits","_super","_createSuper","props","state","_this","_classCallCheck","_defineProperty","_assertThisInitialized","call","forwardRef","current","messageEvtListener","evt","processWindowMessage","popupOpen","authInfo","key","value","window","addEventListener","this","localStorage","processLoginResult","JSON","parse","removeItem","ex","console","error","loadAuthInfo","removeEventListener","loginPopop","React","className","style","backgroundImage","renderLoginState","renderLoginButton","_this2","onClick","onLoginClick","faucetConfig","modules","zupass","infoHtml","OverlayTrigger","placement","overlay","renderInfoHtml","xmlns","width","height","fill","viewBox","d","href","preventDefault","src","_this3","onLogoutClick","delay","show","hide","renderZupassTicketInfo","attendeeId","ticketInfo","Tooltip","_extends","id","ticketId","eventId","productId","dangerouslySetInnerHTML","__html","_this$state$authInfo","token","_this4","args","ticket","argumentType","ArgumentTypeName","PCD","pcdType","EdDSATicketPCDPackage","name","undefined","userProvided","validatorParams","eventIds","event","productIds","notFoundMessage","identity","SemaphoreIdentityPCDPackage","validEventIds","StringArray","length","fieldsToReveal","ToggleList","revealTicketId","revealEventId","revealAttendeeSemaphoreId","revealProductId","externalNullifier","BigInt","nullifier","watermark","req","type","Get","returnUrl","redirectUrl","faucetContext","faucetApi","getApiUrl","options","genericProveScreen","title","description","encReq","encodeURIComponent","stringify","url","concat","open","setState","pollPopupState","_this5","closed","setTimeout","data","_typeof","authModule","authResult","log","close","errorCode","showDialog","body","errorMessage","closeButton","caption"],"sourceRoot":""}